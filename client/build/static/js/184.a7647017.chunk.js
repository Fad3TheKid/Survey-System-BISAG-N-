"use strict";(self.webpackChunkformflow_client=self.webpackChunkformflow_client||[]).push([[184],{4184:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var n=s(5043),r=s(6213),i=s(1238),d=s(579);const l=()=>{const[e,t]=(0,n.useState)(null),[s,l]=(0,n.useState)([]),[a,o]=(0,n.useState)(!0),[c,h]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=await r.A.get("http://localhost:4000/api/admin/formIdByTitle",{params:{title:"Employee Registration Form"}});t(e.data.formId)}catch(e){h("Failed to fetch form ID"),o(!1)}})()}),[]),(0,n.useEffect)((()=>{if(!e)return;(async()=>{try{const t=await r.A.get(`/api/responses/form/${e}`);l(t.data),o(!1)}catch(t){h("Failed to fetch responses"),o(!1)}})()}),[e]);return a?(0,d.jsx)("div",{children:"Loading..."}):c?(0,d.jsxs)("div",{children:["Error: ",c]}):(0,d.jsxs)("div",{style:{padding:20},children:[(0,d.jsx)("h2",{children:"Employee Registration Details"}),(0,d.jsx)("button",{onClick:()=>{if(0===s.length)return;const e=s.map((e=>{const t={};return e.answers.forEach((e=>{t[e.questionId]=e.value})),t["Respondent Email"]=e.respondentEmail||"",t["IP Address"]=e.ipAddress||"",t["User Agent"]=e.userAgent||"",t["Start Time"]=e.startTime||"",t["End Time"]=e.endTime||"",t})),t=i.Wp.json_to_sheet(e),n=i.Wp.book_new();i.Wp.book_append_sheet(n,t,"EmployeeDetails"),i._h(n,"EmployeeDetails.xlsx")},style:{marginBottom:10},children:"Export to Excel"}),(0,d.jsxs)("table",{border:"1",cellPadding:"5",cellSpacing:"0",style:{width:"100%",borderCollapse:"collapse"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"Respondent Email"}),(0,d.jsx)("th",{children:"IP Address"}),(0,d.jsx)("th",{children:"User Agent"}),(0,d.jsx)("th",{children:"Start Time"}),(0,d.jsx)("th",{children:"End Time"}),s.length>0&&Object.keys(s[0].answers.reduce(((e,t)=>(e[t.questionId]=!0,e)),{})).map((e=>(0,d.jsx)("th",{children:e},e)))]})}),(0,d.jsx)("tbody",{children:s.map((e=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:e.respondentEmail||""}),(0,d.jsx)("td",{children:e.ipAddress||""}),(0,d.jsx)("td",{children:e.userAgent||""}),(0,d.jsx)("td",{children:e.startTime?new Date(e.startTime).toLocaleString():""}),(0,d.jsx)("td",{children:e.endTime?new Date(e.endTime).toLocaleString():""}),Object.keys(e.answers.reduce(((e,t)=>(e[t.questionId]=t.value,e)),{})).map((t=>{const s=e.answers.find((e=>e.questionId===t));return(0,d.jsx)("td",{children:s?s.value:""},t)}))]},e._id)))})]})]})}}}]);
//# sourceMappingURL=184.a7647017.chunk.js.map