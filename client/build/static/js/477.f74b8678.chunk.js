"use strict";(self.webpackChunkformflow_client=self.webpackChunkformflow_client||[]).push([[477],{2477:(e,o,t)=>{t.r(o),t.d(o,{default:()=>d});var r=t(5043),n=t(4505),i=t(1238),l=t(579);const d=()=>{const[e,o]=(0,r.useState)([]),[t,d]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[p,c]=(0,r.useState)(null),[g,u]=(0,r.useState)(null),[y,b]=(0,r.useState)(""),[h,m]=(0,r.useState)(!1),[x,f]=(0,r.useState)(null),[D,j]=(0,r.useState)(""),w=e=>null===e||void 0===e?"-":Array.isArray(e)?e.join(", "):"object"===typeof e?"[Object]":e,v=e=>{if(null===e||void 0===e)return"-";if(Array.isArray(e))return e.join(", ");if("object"===typeof e)return"[Object]";const o=t.find((o=>o.dept_id===e||o._id===e));return o?o.name:e};(0,r.useEffect)((()=>{(async()=>{try{const e=await n.qx.getDepartments();d(e)}catch(e){console.error("Failed to fetch departments:",e)}try{const e=await n.e6.getEmployees();o(e)}catch(e){c("Failed to fetch employee details.")}finally{s(!1)}})()}),[]);return a?(0,l.jsx)("div",{style:{padding:20,fontFamily:"Arial, sans-serif"},children:"Loading employee details..."}):p?(0,l.jsx)("div",{style:{padding:20,fontFamily:"Arial, sans-serif",color:"red"},children:p}):(0,l.jsxs)("div",{style:{maxWidth:"95vw",margin:"20px auto",backgroundColor:"#ffffff",borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontFamily:"Arial, sans-serif",padding:20,overflowX:"auto"},children:[(0,l.jsx)("h2",{style:{textAlign:"center",marginBottom:10,color:"#03045e",borderBottom:"3px solid #03045e",paddingBottom:10},children:"Employee Details"}),(0,l.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",marginBottom:25,gap:15},children:[(0,l.jsx)("button",{onClick:()=>{const o=e.map((e=>({"Employee ID":w(e.employeeId),"Employee Name":w(e.employeeName),"Employee Email":w(e.email),Department:w(v(e.department)),Level:w(e.level),Designation:w(e.designation),"Reporting Authority Name":w(e.reportingAuthorityName),"Reporting Authority Department":w(v(e.reportingAuthorityDepartment)),"Reporting Authority Level":w(e.reportingAuthorityLevel),"Reporting Authority Designation":w(e.reportingAuthorityDesignation),"Date of Joining":e.dateOfJoining?new Date(e.dateOfJoining).toLocaleDateString():"-"}))),t=i.Wp.json_to_sheet(o),r=i.Wp.book_new();i.Wp.book_append_sheet(r,t,"Employees"),i._h(r,"EmployeeDetails_All.xlsx")},style:{backgroundColor:"transparent",color:"#03045e",border:"1px solid #03045e",borderRadius:6,padding:"12px 24px",cursor:"pointer",fontWeight:"600",flexGrow:1,minWidth:140,transition:"background-color 0.3s, color 0.3s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#03045e",e.currentTarget.style.color="white"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#03045e"},children:"Download All"}),(0,l.jsx)("button",{onClick:()=>f("individual"),style:{backgroundColor:"transparent",color:"#0077b6",border:"1px solid #0077b6",borderRadius:6,padding:"12px 24px",cursor:"pointer",fontWeight:"600",flexGrow:1,minWidth:160,transition:"background-color 0.3s, color 0.3s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#0077b6",e.currentTarget.style.color="white"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#0077b6"},children:"Download Individual"}),"individual"===x&&(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:20,flexGrow:3,minWidth:220},children:[(0,l.jsx)("input",{type:"text",placeholder:"Enter Employee ID",value:D,onChange:e=>j(e.target.value),style:{padding:"8px 12px",borderRadius:"6px 0 0 6px",border:"1px solid #90e0ef",borderRight:"none",flexGrow:1,color:"#03045e",fontSize:16}}),(0,l.jsx)("button",{onClick:()=>{const o=e.find((e=>e.employeeId===D));if(!o)return void alert("Employee ID not found");const t=[{"Employee ID":w(o.employeeId),"Employee Name":w(o.employeeName),"Employee Email":w(o.email),Department:w(v(o.department)),Level:w(o.level),Designation:w(o.designation),"Reporting Authority Name":w(o.reportingAuthorityName),"Reporting Authority Department":w(v(o.reportingAuthorityDepartment)),"Reporting Authority Level":w(o.reportingAuthorityLevel),"Reporting Authority Designation":w(o.reportingAuthorityDesignation),"Date of Joining":o.dateOfJoining?new Date(o.dateOfJoining).toLocaleDateString():"-"}],r=i.Wp.json_to_sheet(t),n=i.Wp.book_new();i.Wp.book_append_sheet(n,r,"Employee"),i._h(n,`EmployeeDetails_${D}.xlsx`),j("")},style:{backgroundColor:"#0077b6",color:"#caf0f8",border:"1px solid #0077b6",borderRadius:"0 6px 6px 0",padding:"8px 12px",cursor:"pointer",fontWeight:"600",fontSize:18,display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none"},title:"Download Employee Details",children:"\u25bc"})]}),(0,l.jsx)("input",{type:"file",accept:".xlsx, .xls",onChange:e=>{const o=e.target.files[0];if(!o)return;const t=new FileReader;t.onload=e=>{const o=new Uint8Array(e.target.result),t=i.LF(o,{type:"array"}),r=t.SheetNames[0],n=t.Sheets[r],l=i.Wp.sheet_to_json(n,{defval:""});u(l)},t.readAsArrayBuffer(o)},style:{marginLeft:20,padding:"8px 12px",borderRadius:6,border:"1px solid #90e0ef",cursor:"pointer",flexGrow:3,minWidth:220,backgroundColor:"#caf0f8",color:"#03045e"}}),g&&(0,l.jsx)("button",{onClick:async()=>{if(!g||0===g.length)return void alert("No data to upload");const t=new Set(e.map((e=>e.employeeId))),r=g.filter((e=>t.has(e["Employee ID"])));if(r.length>0)return void alert(`Duplicate Employee IDs found: ${r.map((e=>e["Employee ID"])).join(", ")}`);const i=g.map((e=>e["Employee Email"])).filter((e=>e)).map((e=>e.trim().toLowerCase()));try{const e=((await n.Ay.post("/employee/check-emails",{emails:i})).data.existingEmails||[]).map((e=>e.toLowerCase())),t=g.filter((o=>e.includes(o["Employee Email"].trim().toLowerCase()))),r=g.filter((o=>!e.includes(o["Employee Email"].trim().toLowerCase())));if(r.length>0){const e=r.map((e=>e["Employee ID"]));alert(`The following Employee IDs have emails not found in user database: ${e.join(", ")}`)}if(0===t.length)return void alert("No valid employees to upload.");const l=t.map((e=>({employeeId:e["Employee ID"]||"",employeeName:e["Employee Name"]||"",email:e["Employee Email"]||"",department:e.Department||"",level:e.Level||"",designation:e.Designation||"",reportingAuthorityName:e["Reporting Authority Name"]||"",reportingAuthorityDepartment:e["Reporting Authority Department"]||"",reportingAuthorityLevel:e["Reporting Authority Level"]||"",reportingAuthorityDesignation:e["Reporting Authority Designation"]||"",dateOfJoining:e["Date of Joining"]?new Date(e["Date of Joining"]).toISOString():""}))),d=await n.e6.createEmployees(l);d&&d.savedEmployees&&d.savedEmployees.length>0&&o((e=>[...e,...d.savedEmployees])),u(null)}catch(l){alert(`Failed to validate or upload employees: ${l}`)}},style:{backgroundColor:"#00b4d8",color:"#03045e",border:"none",borderRadius:6,padding:"12px 24px",cursor:"pointer",fontWeight:"600",marginLeft:15,flexGrow:1,minWidth:120,transition:"background-color 0.3s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#90e0ef",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#00b4d8",children:"Upload"}),!h&&(0,l.jsx)("button",{onClick:()=>m(!0),style:{backgroundColor:"#c82333",color:"white",border:"none",borderRadius:6,padding:"10px 20px",cursor:"pointer",fontWeight:"600",transition:"background-color 0.3s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#a71d2a",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#c82333",children:"Delete"}),h&&(0,l.jsxs)("div",{style:{marginBottom:25,display:"flex",alignItems:"center",gap:15},children:[(0,l.jsxs)("label",{style:{fontWeight:"600",fontSize:16,color:"#03045e"},children:["Enter Employee ID to Delete:",(0,l.jsx)("input",{type:"text",value:y,onChange:e=>b(e.target.value),style:{padding:8,fontSize:16,marginLeft:15,borderRadius:6,border:"1px solid #90e0ef",width:240,color:"#03045e"}})]}),(0,l.jsx)("button",{onClick:async()=>{if(y)try{await n.e6.deleteEmployee(y),o((e=>e.filter((e=>e.employeeId!==y)))),b(""),m(!1)}catch(e){alert(`Failed to delete employee: ${e}`)}else alert("Please enter an Employee ID to delete")},style:{backgroundColor:"#c82333",color:"white",border:"none",borderRadius:6,padding:"10px 20px",cursor:"pointer",fontWeight:"600",transition:"background-color 0.3s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#a71d2a",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#c82333",children:"Delete"})]})]}),(0,l.jsx)("div",{style:{overflowX:"auto"},children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:"0 1px",marginBottom:15},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{style:{backgroundColor:"#0b3d91"},children:[(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Employee ID"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Employee Name"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Employee Email"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Department"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Level"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Designation"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Reporting Authority Name"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Reporting Authority Department"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Reporting Authority Level"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Reporting Authority Designation"}),(0,l.jsx)("th",{style:{padding:"10px",border:"1px solid #0b3d91",backgroundColor:"#0b3d91",color:"white"},children:"Date of Joining"})]})}),(0,l.jsx)("tbody",{children:e.map((e=>(0,l.jsxs)("tr",{style:{borderBottom:"1px solid #bbdefb",backgroundColor:"#e8eaf6"},children:[(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.employeeId)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.employeeName)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.email)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(v(e.department))}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.level)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.designation)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.reportingAuthorityName)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(v(e.reportingAuthorityDepartment))}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.reportingAuthorityLevel)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.reportingAuthorityDesignation)}),(0,l.jsx)("td",{style:{padding:"8px",border:"1px solid #bbdefb"},children:w(e.dateOfJoining?new Date(e.dateOfJoining).toLocaleDateString():"-")})]},e._id)))})]})})]})}}}]);
//# sourceMappingURL=477.f74b8678.chunk.js.map